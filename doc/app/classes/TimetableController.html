<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: TimetableController</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">TimetableController</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../files/app/controllers/timetable_controller_rb.html">
                app/controllers/timetable_controller.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="ApplicationController.html">
                ApplicationController
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">



   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000689">delete_employee2</a>&nbsp;&nbsp;
      <a href="#M000675">delete_subject</a>&nbsp;&nbsp;
      <a href="#M000676">edit</a>&nbsp;&nbsp;
      <a href="#M000686">edit2</a>&nbsp;&nbsp;
      <a href="#M000670">extra_class</a>&nbsp;&nbsp;
      <a href="#M000671">extra_class_edit</a>&nbsp;&nbsp;
      <a href="#M000669">generate</a>&nbsp;&nbsp;
      <a href="#M000672">list_employee_by_subject</a>&nbsp;&nbsp;
      <a href="#M000673">save_extra_class</a>&nbsp;&nbsp;
      <a href="#M000677">select_class</a>&nbsp;&nbsp;
      <a href="#M000685">select_class2</a>&nbsp;&nbsp;
      <a href="#M000683">student_view</a>&nbsp;&nbsp;
      <a href="#M000674">timetable</a>&nbsp;&nbsp;
      <a href="#M000692">timetable_pdf</a>&nbsp;&nbsp;
      <a href="#M000680">tt_entry_noupdate</a>&nbsp;&nbsp;
      <a href="#M000691">tt_entry_noupdate2</a>&nbsp;&nbsp;
      <a href="#M000679">tt_entry_update</a>&nbsp;&nbsp;
      <a href="#M000690">tt_entry_update2</a>&nbsp;&nbsp;
      <a href="#M000687">update_employees</a>&nbsp;&nbsp;
      <a href="#M000681">update_multiple_timetable_entries</a>&nbsp;&nbsp;
      <a href="#M000688">update_multiple_timetable_entries2</a>&nbsp;&nbsp;
      <a href="#M000684">update_timetable_view</a>&nbsp;&nbsp;
      <a href="#M000682">view</a>&nbsp;&nbsp;
      <a href="#M000678">weekdays</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000689" class="method-detail">
        <a name="M000689"></a>

        <div class="method-heading">
          <a href="#M000689" class="method-signature">
          <span class="method-name">delete_employee2</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000689-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000689-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/timetable_controller.rb, line 367</span>
367:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">delete_employee2</span>
368:     <span class="ruby-ivar">@weekday</span> = [<span class="ruby-value str">&quot;Sun&quot;</span>, <span class="ruby-value str">&quot;Mon&quot;</span>, <span class="ruby-value str">&quot;Tue&quot;</span>, <span class="ruby-value str">&quot;Wed&quot;</span>, <span class="ruby-value str">&quot;Thu&quot;</span>, <span class="ruby-value str">&quot;Fri&quot;</span>, <span class="ruby-value str">&quot;Sat&quot;</span>]
369:     <span class="ruby-ivar">@errors</span> = {<span class="ruby-value str">&quot;messages&quot;</span> =<span class="ruby-operator">&gt;</span> []}
370:     <span class="ruby-identifier">tte</span>=<span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>], <span class="ruby-identifier">:subject_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">:employee_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>)
371:     <span class="ruby-ivar">@timetable</span> = <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-identifier">tte</span>.<span class="ruby-identifier">batch_id</span>)
372:     <span class="ruby-identifier">render</span> <span class="ruby-identifier">:partial</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;edit_tt_multiple2&quot;</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@timetable</span>
373:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000675" class="method-detail">
        <a name="M000675"></a>

        <div class="method-heading">
          <a href="#M000675" class="method-signature">
          <span class="method-name">delete_subject</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000675-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000675-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/timetable_controller.rb, line 127</span>
127:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">delete_subject</span>
128:     <span class="ruby-ivar">@weekday</span> = [<span class="ruby-value str">&quot;Sun&quot;</span>, <span class="ruby-value str">&quot;Mon&quot;</span>, <span class="ruby-value str">&quot;Tue&quot;</span>, <span class="ruby-value str">&quot;Wed&quot;</span>, <span class="ruby-value str">&quot;Thu&quot;</span>, <span class="ruby-value str">&quot;Fri&quot;</span>, <span class="ruby-value str">&quot;Sat&quot;</span>]
129:     <span class="ruby-ivar">@errors</span> = {<span class="ruby-value str">&quot;messages&quot;</span> =<span class="ruby-operator">&gt;</span> []}
130:     <span class="ruby-identifier">tte</span> = <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>], <span class="ruby-identifier">:subject_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>)
131:     <span class="ruby-ivar">@timetable</span> = <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-identifier">tte</span>.<span class="ruby-identifier">batch_id</span>)
132:     <span class="ruby-identifier">render</span> <span class="ruby-identifier">:partial</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;edit_tt_multiple&quot;</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@timetable</span>
133:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000676" class="method-detail">
        <a name="M000676"></a>

        <div class="method-heading">
          <a href="#M000676" class="method-signature">
          <span class="method-name">edit</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000676-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000676-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/timetable_controller.rb, line 135</span>
135:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">edit</span>
136:     <span class="ruby-ivar">@weekday</span> = [<span class="ruby-value str">&quot;Sun&quot;</span>, <span class="ruby-value str">&quot;Mon&quot;</span>, <span class="ruby-value str">&quot;Tue&quot;</span>, <span class="ruby-value str">&quot;Wed&quot;</span>, <span class="ruby-value str">&quot;Thu&quot;</span>, <span class="ruby-value str">&quot;Fri&quot;</span>, <span class="ruby-value str">&quot;Sat&quot;</span>]
137:     <span class="ruby-ivar">@errors</span> = {<span class="ruby-value str">&quot;messages&quot;</span> =<span class="ruby-operator">&gt;</span> []}
138:     <span class="ruby-ivar">@batch</span> = <span class="ruby-constant">Batch</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
139:     <span class="ruby-ivar">@timetable</span> = <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
140:     <span class="ruby-ivar">@class_timing</span> = <span class="ruby-constant">ClassTiming</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;is_break = false&quot;</span>)
141:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@class_timing</span>.<span class="ruby-identifier">empty?</span>
142:       <span class="ruby-ivar">@class_timing</span> = <span class="ruby-constant">ClassTiming</span>.<span class="ruby-identifier">default</span>
143:     <span class="ruby-keyword kw">end</span>
144:     <span class="ruby-ivar">@day</span> = <span class="ruby-constant">Weekday</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>)
145:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@day</span>.<span class="ruby-identifier">empty?</span>
146:       <span class="ruby-ivar">@day</span> = <span class="ruby-constant">Weekday</span>.<span class="ruby-identifier">default</span>
147:     <span class="ruby-keyword kw">end</span>
148:     <span class="ruby-ivar">@subjects</span> = <span class="ruby-constant">Subject</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:conditions=</span><span class="ruby-operator">&gt;</span>[<span class="ruby-value str">&quot;elective_group_id IS NULL AND is_deleted = false&quot;</span>])
149:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000686" class="method-detail">
        <a name="M000686"></a>

        <div class="method-heading">
          <a href="#M000686" class="method-signature">
          <span class="method-name">edit2</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000686-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000686-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/timetable_controller.rb, line 297</span>
297:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">edit2</span>
298:     <span class="ruby-ivar">@weekday</span> = [<span class="ruby-value str">&quot;Sun&quot;</span>, <span class="ruby-value str">&quot;Mon&quot;</span>, <span class="ruby-value str">&quot;Tue&quot;</span>, <span class="ruby-value str">&quot;Wed&quot;</span>, <span class="ruby-value str">&quot;Thu&quot;</span>, <span class="ruby-value str">&quot;Fri&quot;</span>, <span class="ruby-value str">&quot;Sat&quot;</span>]
299:     <span class="ruby-ivar">@errors</span> = {<span class="ruby-value str">&quot;messages&quot;</span> =<span class="ruby-operator">&gt;</span> []}
300:     <span class="ruby-ivar">@batch</span> = <span class="ruby-constant">Batch</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
301:     <span class="ruby-ivar">@timetable</span> = <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
302:     <span class="ruby-ivar">@class_timing</span> = <span class="ruby-constant">ClassTiming</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;is_break = false&quot;</span>)
303:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@class_timing</span>.<span class="ruby-identifier">empty?</span>
304:       <span class="ruby-ivar">@class_timing</span> = <span class="ruby-constant">ClassTiming</span>.<span class="ruby-identifier">default</span>
305:     <span class="ruby-keyword kw">end</span>
306:     <span class="ruby-ivar">@day</span> = <span class="ruby-constant">Weekday</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>)
307:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@day</span>.<span class="ruby-identifier">empty?</span>
308:       <span class="ruby-ivar">@day</span> = <span class="ruby-constant">Weekday</span>.<span class="ruby-identifier">default</span>
309:     <span class="ruby-keyword kw">end</span>
310:     <span class="ruby-ivar">@subjects</span> = <span class="ruby-constant">Subject</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>)
311:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000670" class="method-detail">
        <a name="M000670"></a>

        <div class="method-heading">
          <a href="#M000670" class="method-signature">
          <span class="method-name">extra_class</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000670-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000670-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/timetable_controller.rb, line 78</span>
78:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">extra_class</span>
79:     <span class="ruby-ivar">@config</span> = <span class="ruby-constant">Configuration</span>.<span class="ruby-identifier">available_modules</span>
80:     <span class="ruby-keyword kw">unless</span>   <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:extra_class</span>].<span class="ruby-identifier">nil?</span>
81:       <span class="ruby-ivar">@date</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:extra_class</span>][<span class="ruby-identifier">:date</span>].<span class="ruby-identifier">to_date</span>
82:       <span class="ruby-ivar">@batch</span> = <span class="ruby-constant">Batch</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:extra_class</span>][<span class="ruby-identifier">:batch_id</span>])
83:       <span class="ruby-ivar">@period_entry</span> = <span class="ruby-constant">PeriodEntry</span>.<span class="ruby-identifier">find_all_by_batch_id_and_month_date</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>, <span class="ruby-ivar">@date</span>)
84:       <span class="ruby-identifier">render</span> (<span class="ruby-identifier">:update</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">page</span><span class="ruby-operator">|</span>
85:         <span class="ruby-identifier">page</span>.<span class="ruby-identifier">replace_html</span> <span class="ruby-value str">'extra-class-form'</span>, <span class="ruby-identifier">:partial</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;extra_class_form&quot;</span>
86:       <span class="ruby-keyword kw">end</span>
87:     <span class="ruby-keyword kw">end</span>
88:       
89:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000671" class="method-detail">
        <a name="M000671"></a>

        <div class="method-heading">
          <a href="#M000671" class="method-signature">
          <span class="method-name">extra_class_edit</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000671-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000671-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/timetable_controller.rb, line 90</span>
90:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">extra_class_edit</span>
91:     <span class="ruby-ivar">@config</span> = <span class="ruby-constant">Configuration</span>.<span class="ruby-identifier">available_modules</span>
92:     <span class="ruby-ivar">@period_id</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>]
93:     <span class="ruby-ivar">@period_entry</span> = <span class="ruby-constant">PeriodEntry</span>.<span class="ruby-identifier">find</span>(<span class="ruby-ivar">@period_id</span>)
94:     <span class="ruby-ivar">@subjects</span> = <span class="ruby-constant">Subject</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-ivar">@period_entry</span>.<span class="ruby-identifier">batch_id</span>,<span class="ruby-identifier">:conditions=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'is_deleted=false'</span>)
95:     <span class="ruby-ivar">@employee</span> = <span class="ruby-constant">EmployeesSubject</span>.<span class="ruby-identifier">find_all_by_subject_id</span>(<span class="ruby-ivar">@period_entry</span>.<span class="ruby-identifier">subject_id</span>)
96:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000669" class="method-detail">
        <a name="M000669"></a>

        <div class="method-heading">
          <a href="#M000669" class="method-signature">
          <span class="method-name">generate</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000669-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000669-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/timetable_controller.rb, line 6</span>
 6:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">generate</span>
 7:     <span class="ruby-ivar">@batches</span> = <span class="ruby-constant">Batch</span>.<span class="ruby-identifier">active</span>
 8:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span>
 9:       <span class="ruby-ivar">@batch</span> = <span class="ruby-constant">Batch</span>.<span class="ruby-identifier">find</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:timetable</span>][<span class="ruby-identifier">:batch_id</span>]
10:       <span class="ruby-ivar">@config</span> = <span class="ruby-constant">Configuration</span>.<span class="ruby-identifier">find_by_config_key</span>(<span class="ruby-value str">'StudentAttendanceType'</span>)
11:       <span class="ruby-ivar">@start_date</span> = <span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">start_date</span>.<span class="ruby-identifier">to_date</span>
12:       <span class="ruby-ivar">@end_date</span> = <span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">end_date</span>.<span class="ruby-identifier">to_date</span>
13:       <span class="ruby-identifier">holiday</span> = []
14:       <span class="ruby-ivar">@holiday</span> = <span class="ruby-constant">Weekday</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>)
15:       <span class="ruby-ivar">@holiday</span> = <span class="ruby-constant">Weekday</span>.<span class="ruby-identifier">default</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@holiday</span>.<span class="ruby-identifier">empty?</span>
16:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">'You have set the weekdays!'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@holiday</span>.<span class="ruby-identifier">empty?</span>
17:       <span class="ruby-ivar">@holiday</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">h</span><span class="ruby-operator">|</span>
18:         <span class="ruby-identifier">holiday</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">h</span>.<span class="ruby-identifier">weekday</span>
19:       <span class="ruby-keyword kw">end</span>
20:       <span class="ruby-identifier">set</span> = <span class="ruby-value">0</span>
21:       (<span class="ruby-ivar">@start_date</span><span class="ruby-operator">..</span><span class="ruby-ivar">@end_date</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">d</span><span class="ruby-operator">|</span>
22:         <span class="ruby-identifier">w</span> = <span class="ruby-identifier">d</span>.<span class="ruby-identifier">wday</span>.<span class="ruby-identifier">to_s</span>
23:         <span class="ruby-ivar">@period</span> = <span class="ruby-constant">PeriodEntry</span>.<span class="ruby-identifier">find_all_by_month_date_and_batch_id</span>(<span class="ruby-identifier">d</span>,<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>)
24:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@period</span>.<span class="ruby-identifier">empty?</span>
25:           <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Event</span>.<span class="ruby-identifier">is_a_holiday?</span>(<span class="ruby-identifier">d</span>)
26:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">holiday</span>.<span class="ruby-identifier">include?</span> <span class="ruby-identifier">w</span>
27:               <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@config</span>.<span class="ruby-identifier">config_value</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'Daily'</span>
28:                 <span class="ruby-ivar">@timetable</span> = <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">find_all_by_batch_id_and_week_day_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">wday</span>)
29:                 <span class="ruby-ivar">@timetable</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
30:                   <span class="ruby-constant">PeriodEntry</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:month_date=</span><span class="ruby-operator">&gt;</span> <span class="ruby-identifier">d</span>, <span class="ruby-identifier">:batch_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:subject_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">subject_id</span>, <span class="ruby-identifier">:class_timing_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">class_timing_id</span>, <span class="ruby-identifier">:employee_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">employee_id</span>)
31:                   <span class="ruby-identifier">set</span> = <span class="ruby-value">2</span>
32:                 <span class="ruby-keyword kw">end</span>
33:               <span class="ruby-keyword kw">else</span>
34:                 <span class="ruby-constant">PeriodEntry</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:month_date=</span><span class="ruby-operator">&gt;</span> <span class="ruby-identifier">d</span>, <span class="ruby-identifier">:batch_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>)
35:                 <span class="ruby-identifier">set</span> = <span class="ruby-value">2</span>
36:               <span class="ruby-keyword kw">end</span>
37:             <span class="ruby-keyword kw">end</span>
38:           <span class="ruby-keyword kw">end</span>
39:         <span class="ruby-keyword kw">else</span>
40:           <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@config</span>.<span class="ruby-identifier">config_value</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'Daily'</span>
41:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">d</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-constant">Date</span>.<span class="ruby-identifier">today</span>
42:               <span class="ruby-ivar">@timetable</span> = <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">find_all_by_batch_id_and_week_day_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">wday</span>)
43:               <span class="ruby-ivar">@period</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span>
44:                 <span class="ruby-ivar">@timetable</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
45:                   <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">class_timing_id</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">class_timing_id</span>
46:                     <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">subject_id</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">subject_id</span>
47:                       <span class="ruby-constant">PeriodEntry</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">p</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:month_date=</span><span class="ruby-operator">&gt;</span> <span class="ruby-identifier">d</span>, <span class="ruby-identifier">:batch_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:subject_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">subject_id</span>, <span class="ruby-identifier">:class_timing_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">class_timing_id</span>, <span class="ruby-identifier">:employee_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">employee_id</span>)
48:                       <span class="ruby-identifier">set</span> = <span class="ruby-value">1</span>
49:                       
50: 
51:                     <span class="ruby-keyword kw">end</span>
52:                   <span class="ruby-keyword kw">end</span>
53:                 <span class="ruby-keyword kw">end</span>
54: 
55:               <span class="ruby-keyword kw">end</span>
56:             <span class="ruby-keyword kw">end</span>
57:           <span class="ruby-keyword kw">end</span>
58:         <span class="ruby-keyword kw">end</span>
59:           
60:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">set</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
61:           <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">'Timetable has already been published'</span>
62:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">set</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
63:           <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">'Timetable updated'</span>
64:         <span class="ruby-keyword kw">else</span>
65:           <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">'Timetable created successfully'</span>
66:         <span class="ruby-keyword kw">end</span>
67:       <span class="ruby-keyword kw">end</span>
68:     
69:       <span class="ruby-ivar">@config</span> = <span class="ruby-constant">Configuration</span>.<span class="ruby-identifier">available_modules</span>
70:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@config</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">'HR'</span>)
71:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;edit2&quot;</span>, <span class="ruby-identifier">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>
72:       <span class="ruby-keyword kw">else</span>
73:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;edit&quot;</span>, <span class="ruby-identifier">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>
74:       <span class="ruby-keyword kw">end</span>
75:     <span class="ruby-keyword kw">end</span>
76:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000672" class="method-detail">
        <a name="M000672"></a>

        <div class="method-heading">
          <a href="#M000672" class="method-signature">
          <span class="method-name">list_employee_by_subject</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000672-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000672-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/timetable_controller.rb, line 97</span>
 97:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">list_employee_by_subject</span>
 98:     <span class="ruby-ivar">@period_id</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:period_id</span>]
 99:     <span class="ruby-ivar">@subject</span> = <span class="ruby-constant">Subject</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:subject_id</span>])
100:     <span class="ruby-ivar">@employee</span> = <span class="ruby-constant">EmployeesSubject</span>.<span class="ruby-identifier">find_all_by_subject_id</span>(<span class="ruby-ivar">@subject</span>.<span class="ruby-identifier">id</span>)
101:     <span class="ruby-identifier">render</span> (<span class="ruby-identifier">:update</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">page</span><span class="ruby-operator">|</span>
102:       <span class="ruby-identifier">page</span>.<span class="ruby-identifier">replace_html</span> <span class="ruby-node">&quot;employee-update-#{@period_id}&quot;</span>, <span class="ruby-identifier">:partial</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;list_employee_by_subject&quot;</span>
103:     <span class="ruby-keyword kw">end</span>
104:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000673" class="method-detail">
        <a name="M000673"></a>

        <div class="method-heading">
          <a href="#M000673" class="method-signature">
          <span class="method-name">save_extra_class</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000673-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000673-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/timetable_controller.rb, line 105</span>
105:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">save_extra_class</span>
106:     <span class="ruby-ivar">@period</span> = <span class="ruby-constant">PeriodEntry</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:period_entry</span>][<span class="ruby-identifier">:period_id</span>])
107:     <span class="ruby-constant">PeriodEntry</span>.<span class="ruby-identifier">update</span>(<span class="ruby-ivar">@period</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:subject_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:period_entry</span>][<span class="ruby-identifier">:subject_id</span>], <span class="ruby-identifier">:employee_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:period_entry</span>][<span class="ruby-identifier">:employee_id</span>])
108:     <span class="ruby-ivar">@period</span> = <span class="ruby-constant">PeriodEntry</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:period_entry</span>][<span class="ruby-identifier">:period_id</span>])
109:     <span class="ruby-identifier">render</span> (<span class="ruby-identifier">:update</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">page</span><span class="ruby-operator">|</span>
110:       <span class="ruby-identifier">page</span>.<span class="ruby-identifier">replace_html</span> <span class="ruby-node">&quot;tr-extra-class-#{@period.id}&quot;</span>, <span class="ruby-identifier">:partial</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'extra_class_update'</span>
111:     <span class="ruby-keyword kw">end</span>
112:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000677" class="method-detail">
        <a name="M000677"></a>

        <div class="method-heading">
          <a href="#M000677" class="method-signature">
          <span class="method-name">select_class</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000677-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000677-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/timetable_controller.rb, line 151</span>
151:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">select_class</span>
152:     <span class="ruby-ivar">@batches</span> = <span class="ruby-constant">Batch</span>.<span class="ruby-identifier">active</span>
153:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span>
154:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:timetable_entry</span>][<span class="ruby-identifier">:batch_id</span>].<span class="ruby-identifier">empty?</span>
155:         <span class="ruby-ivar">@batch</span> = <span class="ruby-constant">Batch</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:timetable_entry</span>][<span class="ruby-identifier">:batch_id</span>])
156:         <span class="ruby-ivar">@class_timings</span> = <span class="ruby-constant">ClassTiming</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>)
157:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@class_timings</span>.<span class="ruby-identifier">empty?</span>
158:           <span class="ruby-ivar">@class_timings</span> = <span class="ruby-constant">ClassTiming</span>.<span class="ruby-identifier">default</span>
159:         <span class="ruby-keyword kw">end</span>
160:         <span class="ruby-ivar">@days</span> = <span class="ruby-constant">Weekday</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>)
161:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@days</span>.<span class="ruby-identifier">empty?</span>
162:           <span class="ruby-ivar">@days</span> = <span class="ruby-constant">Weekday</span>.<span class="ruby-identifier">default</span>
163:         <span class="ruby-keyword kw">end</span>
164:         <span class="ruby-ivar">@days</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">d</span><span class="ruby-operator">|</span>
165:           <span class="ruby-ivar">@class_timings</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span>
166:             <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:batch_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:week_day_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">d</span>.<span class="ruby-identifier">weekday</span>, <span class="ruby-identifier">:class_timing_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">id</span>) \
167:               <span class="ruby-keyword kw">if</span> <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">find_by_batch_id_and_week_day_id_and_class_timing_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">weekday</span>, <span class="ruby-identifier">p</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">nil?</span>
168:           <span class="ruby-keyword kw">end</span>
169:         <span class="ruby-keyword kw">end</span>
170: 
171:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;edit&quot;</span>, <span class="ruby-identifier">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>
172:       <span class="ruby-keyword kw">else</span>
173:         <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;Select a batch to continue&quot;</span>
174:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;select_class&quot;</span>
175:       <span class="ruby-keyword kw">end</span>
176:     <span class="ruby-keyword kw">end</span>
177:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000685" class="method-detail">
        <a name="M000685"></a>

        <div class="method-heading">
          <a href="#M000685" class="method-signature">
          <span class="method-name">select_class2</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
methods given below are for <a
href="TimetableController.html#M000674">timetable</a> with HR module
connected
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000685-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000685-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/timetable_controller.rb, line 269</span>
269:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">select_class2</span>
270:     <span class="ruby-ivar">@weekday</span> = [<span class="ruby-value str">&quot;Sun&quot;</span>, <span class="ruby-value str">&quot;Mon&quot;</span>, <span class="ruby-value str">&quot;Tue&quot;</span>, <span class="ruby-value str">&quot;Wed&quot;</span>, <span class="ruby-value str">&quot;Thu&quot;</span>, <span class="ruby-value str">&quot;Fri&quot;</span>, <span class="ruby-value str">&quot;Sat&quot;</span>]
271:     <span class="ruby-ivar">@batches</span> = <span class="ruby-constant">Batch</span>.<span class="ruby-identifier">active</span>
272:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span>
273:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:timetable_entry</span>][<span class="ruby-identifier">:batch_id</span>].<span class="ruby-identifier">empty?</span>
274:         <span class="ruby-ivar">@batch</span> = <span class="ruby-constant">Batch</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:timetable_entry</span>][<span class="ruby-identifier">:batch_id</span>])
275:         <span class="ruby-ivar">@class_timings</span> = <span class="ruby-constant">ClassTiming</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;is_break = false&quot;</span>)
276:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@class_timings</span>.<span class="ruby-identifier">empty?</span>
277:           <span class="ruby-ivar">@class_timings</span> = <span class="ruby-constant">ClassTiming</span>.<span class="ruby-identifier">default</span>
278:         <span class="ruby-keyword kw">end</span>
279:         <span class="ruby-ivar">@day</span> = <span class="ruby-constant">Weekday</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>)
280:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@day</span>.<span class="ruby-identifier">empty?</span>
281:           <span class="ruby-ivar">@day</span> = <span class="ruby-constant">Weekday</span>.<span class="ruby-identifier">default</span>
282:         <span class="ruby-keyword kw">end</span>
283:         <span class="ruby-ivar">@day</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">d</span><span class="ruby-operator">|</span>
284:           <span class="ruby-ivar">@class_timings</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span>
285:             <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:batch_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:week_day_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">d</span>.<span class="ruby-identifier">weekday</span>, <span class="ruby-identifier">:class_timing_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">id</span>) \
286:               <span class="ruby-keyword kw">if</span> <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">find_by_batch_id_and_week_day_id_and_class_timing_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">weekday</span>, <span class="ruby-identifier">p</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">nil?</span>
287:           <span class="ruby-keyword kw">end</span>
288:         <span class="ruby-keyword kw">end</span>
289:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;edit2&quot;</span>, <span class="ruby-identifier">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>
290:       <span class="ruby-keyword kw">else</span>
291:         <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;Select a batch to continue&quot;</span>
292:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;select_class2&quot;</span>
293:       <span class="ruby-keyword kw">end</span>
294:     <span class="ruby-keyword kw">end</span>
295:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000683" class="method-detail">
        <a name="M000683"></a>

        <div class="method-heading">
          <a href="#M000683" class="method-signature">
          <span class="method-name">student_view</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000683-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000683-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/timetable_controller.rb, line 226</span>
226:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">student_view</span>
227:     <span class="ruby-ivar">@weekday</span> = [<span class="ruby-value str">&quot;Sun&quot;</span>, <span class="ruby-value str">&quot;Mon&quot;</span>, <span class="ruby-value str">&quot;Tue&quot;</span>, <span class="ruby-value str">&quot;Wed&quot;</span>, <span class="ruby-value str">&quot;Thu&quot;</span>, <span class="ruby-value str">&quot;Fri&quot;</span>, <span class="ruby-value str">&quot;Sat&quot;</span>]
228:     <span class="ruby-identifier">student</span> = <span class="ruby-constant">Student</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
229:     <span class="ruby-ivar">@batch</span> = <span class="ruby-identifier">student</span>.<span class="ruby-identifier">batch</span>
230:     <span class="ruby-ivar">@timetable</span> = <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>)
231:     <span class="ruby-ivar">@class_timing</span> = <span class="ruby-constant">ClassTiming</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;is_break = false&quot;</span>)
232:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@class_timing</span>.<span class="ruby-identifier">empty?</span>
233:       <span class="ruby-ivar">@class_timing</span> = <span class="ruby-constant">ClassTiming</span>.<span class="ruby-identifier">default</span>
234:     <span class="ruby-keyword kw">end</span>
235:     <span class="ruby-ivar">@day</span> = <span class="ruby-constant">Weekday</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>)
236:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@day</span>.<span class="ruby-identifier">empty?</span>
237:       <span class="ruby-ivar">@day</span> = <span class="ruby-constant">Weekday</span>.<span class="ruby-identifier">default</span>
238:     <span class="ruby-keyword kw">end</span>
239:     <span class="ruby-ivar">@subjects</span> = <span class="ruby-constant">Subject</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>)
240:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000674" class="method-detail">
        <a name="M000674"></a>

        <div class="method-heading">
          <a href="#M000674" class="method-signature">
          <span class="method-name">timetable</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000674-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000674-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/timetable_controller.rb, line 114</span>
114:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">timetable</span>
115:     <span class="ruby-ivar">@config</span> = <span class="ruby-constant">Configuration</span>.<span class="ruby-identifier">available_modules</span>
116:     <span class="ruby-ivar">@batches</span> = <span class="ruby-constant">Batch</span>.<span class="ruby-identifier">active</span>
117:     <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:next</span>].<span class="ruby-identifier">nil?</span>
118:       <span class="ruby-ivar">@today</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:next</span>].<span class="ruby-identifier">to_date</span>
119:       <span class="ruby-identifier">render</span> (<span class="ruby-identifier">:update</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">page</span><span class="ruby-operator">|</span>
120:         <span class="ruby-identifier">page</span>.<span class="ruby-identifier">replace_html</span> <span class="ruby-value str">&quot;timetable&quot;</span>, <span class="ruby-identifier">:partial</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'table'</span>
121:       <span class="ruby-keyword kw">end</span>
122:     <span class="ruby-keyword kw">else</span>
123:       <span class="ruby-ivar">@today</span> = <span class="ruby-constant">Date</span>.<span class="ruby-identifier">today</span>
124:     <span class="ruby-keyword kw">end</span>
125:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000692" class="method-detail">
        <a name="M000692"></a>

        <div class="method-heading">
          <a href="#M000692" class="method-signature">
          <span class="method-name">timetable_pdf</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
PDF Reports
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000692-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000692-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/timetable_controller.rb, line 395</span>
395:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">timetable_pdf</span>
396:     <span class="ruby-ivar">@batch</span> = <span class="ruby-constant">Batch</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:course_id</span>])
397:     <span class="ruby-ivar">@timetable</span> = <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>)
398:     <span class="ruby-ivar">@class_timing</span> = <span class="ruby-constant">ClassTiming</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;is_break = false&quot;</span>)
399:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@class_timing</span>.<span class="ruby-identifier">empty?</span>
400:       <span class="ruby-ivar">@class_timing</span> = <span class="ruby-constant">ClassTiming</span>.<span class="ruby-identifier">default</span>
401:     <span class="ruby-keyword kw">end</span>
402:     <span class="ruby-ivar">@day</span> = <span class="ruby-constant">Weekday</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>)
403:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@day</span>.<span class="ruby-identifier">empty?</span>
404:       <span class="ruby-ivar">@day</span> = <span class="ruby-constant">Weekday</span>.<span class="ruby-identifier">default</span>
405:     <span class="ruby-keyword kw">end</span>
406:     <span class="ruby-ivar">@subjects</span> = <span class="ruby-constant">Subject</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>)
407:     <span class="ruby-ivar">@weekday</span> = [<span class="ruby-value str">&quot;Sun&quot;</span>, <span class="ruby-value str">&quot;Mon&quot;</span>, <span class="ruby-value str">&quot;Tue&quot;</span>, <span class="ruby-value str">&quot;Wed&quot;</span>, <span class="ruby-value str">&quot;Thu&quot;</span>, <span class="ruby-value str">&quot;Fri&quot;</span>, <span class="ruby-value str">&quot;Sat&quot;</span>]
408:     <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
409:       <span class="ruby-identifier">format</span>.<span class="ruby-identifier">pdf</span> { <span class="ruby-identifier">render</span> <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span> }
410:     <span class="ruby-keyword kw">end</span>
411:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000680" class="method-detail">
        <a name="M000680"></a>

        <div class="method-heading">
          <a href="#M000680" class="method-signature">
          <span class="method-name">tt_entry_noupdate</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000680-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000680-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/timetable_controller.rb, line 192</span>
192:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">tt_entry_noupdate</span>
193:     <span class="ruby-identifier">render</span> <span class="ruby-identifier">:update</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;error_div_#{params[:tte_id]}&quot;</span>, <span class="ruby-identifier">:text</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Cancelled.&quot;</span>
194:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000691" class="method-detail">
        <a name="M000691"></a>

        <div class="method-heading">
          <a href="#M000691" class="method-signature">
          <span class="method-name">tt_entry_noupdate2</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000691-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000691-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/timetable_controller.rb, line 391</span>
391:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">tt_entry_noupdate2</span>
392:     <span class="ruby-identifier">render</span> <span class="ruby-identifier">:update</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;error_div_#{params[:tte_id]}&quot;</span>, <span class="ruby-identifier">:text</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Cancelled.&quot;</span>
393:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000679" class="method-detail">
        <a name="M000679"></a>

        <div class="method-heading">
          <a href="#M000679" class="method-signature">
          <span class="method-name">tt_entry_update</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000679-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000679-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/timetable_controller.rb, line 183</span>
183:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">tt_entry_update</span>
184:     <span class="ruby-ivar">@weekday</span> = [<span class="ruby-value str">&quot;Sun&quot;</span>, <span class="ruby-value str">&quot;Mon&quot;</span>, <span class="ruby-value str">&quot;Tue&quot;</span>, <span class="ruby-value str">&quot;Wed&quot;</span>, <span class="ruby-value str">&quot;Thu&quot;</span>, <span class="ruby-value str">&quot;Fri&quot;</span>, <span class="ruby-value str">&quot;Sat&quot;</span>]
185:     <span class="ruby-ivar">@errors</span> = {<span class="ruby-value str">&quot;messages&quot;</span> =<span class="ruby-operator">&gt;</span> []}
186:     <span class="ruby-identifier">subject</span> = <span class="ruby-constant">Subject</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:sub_id</span>])
187:     <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:tte_id</span>], <span class="ruby-identifier">:subject_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:sub_id</span>])
188:     <span class="ruby-ivar">@timetable</span> = <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-identifier">subject</span>.<span class="ruby-identifier">batch_id</span>)
189:     <span class="ruby-identifier">render</span> <span class="ruby-identifier">:partial</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;edit_tt_multiple&quot;</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@timetable</span>
190:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000690" class="method-detail">
        <a name="M000690"></a>

        <div class="method-heading">
          <a href="#M000690" class="method-signature">
          <span class="method-name">tt_entry_update2</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000690-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000690-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/timetable_controller.rb, line 375</span>
375:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">tt_entry_update2</span>
376:     <span class="ruby-ivar">@weekday</span> = [<span class="ruby-value str">&quot;Sun&quot;</span>, <span class="ruby-value str">&quot;Mon&quot;</span>, <span class="ruby-value str">&quot;Tue&quot;</span>, <span class="ruby-value str">&quot;Wed&quot;</span>, <span class="ruby-value str">&quot;Thu&quot;</span>, <span class="ruby-value str">&quot;Fri&quot;</span>, <span class="ruby-value str">&quot;Sat&quot;</span>]
377:     <span class="ruby-ivar">@errors</span> = {<span class="ruby-value str">&quot;messages&quot;</span> =<span class="ruby-operator">&gt;</span> []}
378:     <span class="ruby-identifier">subject</span> = <span class="ruby-constant">Subject</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:sub_id</span>])
379:     <span class="ruby-identifier">tte</span> = <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:tte_id</span>])
380:     <span class="ruby-identifier">overlapped_tte</span> = <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">find_by_week_day_id_and_class_timing_id_and_employee_id</span>(<span class="ruby-identifier">tte</span>.<span class="ruby-identifier">week_day_id</span>,<span class="ruby-identifier">tte</span>.<span class="ruby-identifier">class_timing_id</span>,<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:emp_id</span>])
381:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">overlapped_tte</span>.<span class="ruby-identifier">nil?</span>
382:       <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:tte_id</span>], <span class="ruby-identifier">:subject_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:sub_id</span>], <span class="ruby-identifier">:employee_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:emp_id</span>])
383:     <span class="ruby-keyword kw">else</span>
384:       <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">overlapped_tte</span>.<span class="ruby-identifier">id</span>,<span class="ruby-identifier">:subject_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">:employee_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span> )
385:       <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:tte_id</span>], <span class="ruby-identifier">:subject_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:sub_id</span>], <span class="ruby-identifier">:employee_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:emp_id</span>])
386:     <span class="ruby-keyword kw">end</span>
387:     <span class="ruby-ivar">@timetable</span> = <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-identifier">subject</span>.<span class="ruby-identifier">batch_id</span>)
388:     <span class="ruby-identifier">render</span> <span class="ruby-identifier">:partial</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;edit_tt_multiple2&quot;</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@timetable</span>
389:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000687" class="method-detail">
        <a name="M000687"></a>

        <div class="method-heading">
          <a href="#M000687" class="method-signature">
          <span class="method-name">update_employees</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000687-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000687-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/timetable_controller.rb, line 313</span>
313:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update_employees</span>
314:     <span class="ruby-ivar">@weekday</span> = [<span class="ruby-value str">&quot;Sun&quot;</span>, <span class="ruby-value str">&quot;Mon&quot;</span>, <span class="ruby-value str">&quot;Tue&quot;</span>, <span class="ruby-value str">&quot;Wed&quot;</span>, <span class="ruby-value str">&quot;Thu&quot;</span>, <span class="ruby-value str">&quot;Fri&quot;</span>, <span class="ruby-value str">&quot;Sat&quot;</span>]
315:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:subject_id</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
316:       <span class="ruby-identifier">render</span> <span class="ruby-identifier">:text</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>
317:       <span class="ruby-keyword kw">return</span>
318:     <span class="ruby-keyword kw">end</span>
319:     <span class="ruby-ivar">@employees_subject</span> = <span class="ruby-constant">EmployeesSubject</span>.<span class="ruby-identifier">find_all_by_subject_id</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:subject_id</span>])
320:     <span class="ruby-identifier">render</span> <span class="ruby-identifier">:partial=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;employee_list&quot;</span>
321:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000681" class="method-detail">
        <a name="M000681"></a>

        <div class="method-heading">
          <a href="#M000681" class="method-signature">
          <span class="method-name">update_multiple_timetable_entries</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000681-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000681-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/timetable_controller.rb, line 196</span>
196:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update_multiple_timetable_entries</span>
197:     <span class="ruby-ivar">@weekday</span> = [<span class="ruby-value str">&quot;Sun&quot;</span>, <span class="ruby-value str">&quot;Mon&quot;</span>, <span class="ruby-value str">&quot;Tue&quot;</span>, <span class="ruby-value str">&quot;Wed&quot;</span>, <span class="ruby-value str">&quot;Thu&quot;</span>, <span class="ruby-value str">&quot;Fri&quot;</span>, <span class="ruby-value str">&quot;Sat&quot;</span>]
198:     <span class="ruby-identifier">subject</span> = <span class="ruby-constant">Subject</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:subject_id</span>])
199:     <span class="ruby-identifier">tte_ids</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:tte_ids</span>].<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;,&quot;</span>).<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">to_i</span>}
200:     <span class="ruby-identifier">course</span> = <span class="ruby-identifier">subject</span>.<span class="ruby-identifier">batch</span>
201:     <span class="ruby-ivar">@validation_problems</span> = {}
202: 
203:     <span class="ruby-identifier">tte_ids</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">tte_id</span><span class="ruby-operator">|</span>
204:       <span class="ruby-identifier">errors</span> = { <span class="ruby-value str">&quot;info&quot;</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-value str">&quot;sub_id&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">subject</span>.<span class="ruby-identifier">id</span>, <span class="ruby-value str">&quot;tte_id&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">tte_id</span>},
205:         <span class="ruby-value str">&quot;messages&quot;</span> =<span class="ruby-operator">&gt;</span> [] }
206: 
207:       <span class="ruby-comment cmt"># check for weekly subject limit.</span>
208:       <span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;messages&quot;</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;Weekly subject limit reached.&quot;</span> \
209:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">subject</span>.<span class="ruby-identifier">max_weekly_classes</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">count</span>(<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;subject_id = #{subject.id}&quot;</span>)
210: 
211:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;messages&quot;</span>].<span class="ruby-identifier">empty?</span>
212:         <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">tte_id</span>, <span class="ruby-identifier">:subject_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">subject</span>.<span class="ruby-identifier">id</span>)
213:       <span class="ruby-keyword kw">else</span>
214:         <span class="ruby-ivar">@validation_problems</span>[<span class="ruby-identifier">tte_id</span>] = <span class="ruby-identifier">errors</span>
215:       <span class="ruby-keyword kw">end</span>
216:     <span class="ruby-keyword kw">end</span>
217: 
218:     <span class="ruby-ivar">@timetable</span> = <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-identifier">course</span>.<span class="ruby-identifier">id</span>)
219:     <span class="ruby-identifier">render</span> <span class="ruby-identifier">:partial</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;edit_tt_multiple&quot;</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@timetable</span>
220:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000688" class="method-detail">
        <a name="M000688"></a>

        <div class="method-heading">
          <a href="#M000688" class="method-signature">
          <span class="method-name">update_multiple_timetable_entries2</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000688-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000688-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/timetable_controller.rb, line 323</span>
323:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update_multiple_timetable_entries2</span>
324:     <span class="ruby-ivar">@weekday</span> = [<span class="ruby-value str">&quot;Sun&quot;</span>, <span class="ruby-value str">&quot;Mon&quot;</span>, <span class="ruby-value str">&quot;Tue&quot;</span>, <span class="ruby-value str">&quot;Wed&quot;</span>, <span class="ruby-value str">&quot;Thu&quot;</span>, <span class="ruby-value str">&quot;Fri&quot;</span>, <span class="ruby-value str">&quot;Sat&quot;</span>]
325:     <span class="ruby-identifier">employees_subject</span> = <span class="ruby-constant">EmployeesSubject</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:emp_sub_id</span>])
326:     <span class="ruby-identifier">tte_ids</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:tte_ids</span>].<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;,&quot;</span>).<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">to_i</span>}
327:     <span class="ruby-ivar">@batch</span> = <span class="ruby-identifier">employees_subject</span>.<span class="ruby-identifier">subject</span>.<span class="ruby-identifier">batch</span>
328:     <span class="ruby-identifier">subject</span> = <span class="ruby-identifier">employees_subject</span>.<span class="ruby-identifier">subject</span>
329:     <span class="ruby-identifier">employee</span> = <span class="ruby-identifier">employees_subject</span>.<span class="ruby-identifier">employee</span>
330:     <span class="ruby-ivar">@validation_problems</span> = {}
331: 
332:     <span class="ruby-identifier">tte_ids</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">tte_id</span><span class="ruby-operator">|</span>
333:       <span class="ruby-identifier">tte</span> = <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">tte_id</span>)
334:       <span class="ruby-identifier">errors</span> = { <span class="ruby-value str">&quot;info&quot;</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-value str">&quot;sub_id&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">employees_subject</span>.<span class="ruby-identifier">subject_id</span>, <span class="ruby-value str">&quot;emp_id&quot;</span>=<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">employees_subject</span>.<span class="ruby-identifier">employee_id</span>,<span class="ruby-value str">&quot;tte_id&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">tte_id</span>},
335:         <span class="ruby-value str">&quot;messages&quot;</span> =<span class="ruby-operator">&gt;</span> [] }
336: 
337:       <span class="ruby-comment cmt"># check for weekly subject limit.</span>
338:       <span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;messages&quot;</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;Weekly subject limit reached.&quot;</span> \
339:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">subject</span>.<span class="ruby-identifier">max_weekly_classes</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">count</span>(<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;subject_id = #{subject.id}&quot;</span>)
340: 
341:       <span class="ruby-comment cmt">#check for overlapping classes</span>
342:       <span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;messages&quot;</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;Class overlap occured.&quot;</span> \
343:         <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,
344:         <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;week_day_id = #{tte.week_day_id} AND
345:                                                class_timing_id = #{tte.class_timing_id} AND
346:                                                employee_id = #{employee.id}&quot;</span>).<span class="ruby-identifier">nil?</span>
347: 
348:       <span class="ruby-comment cmt"># check for max_hour_day exceeded</span>
349:       <span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;messages&quot;</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;Max hours per day exceeded.&quot;</span> \
350:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">employee</span>.<span class="ruby-identifier">max_hours_per_day</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">count</span>(<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;employee_id = #{employee.id} AND week_day_id = #{tte.week_day_id}&quot;</span>)
351: 
352:       <span class="ruby-comment cmt"># check for max hours per week</span>
353:       <span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;messages&quot;</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;Max hours per week exceeded.&quot;</span> \
354:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">employee</span>.<span class="ruby-identifier">max_hours_per_week</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">count</span>(<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;employee_id = #{employee.id}&quot;</span>)
355: 
356:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;messages&quot;</span>].<span class="ruby-identifier">empty?</span>
357:         <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">tte_id</span>, <span class="ruby-identifier">:subject_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">subject</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:employee_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">employee</span>.<span class="ruby-identifier">id</span>)
358:       <span class="ruby-keyword kw">else</span>
359:         <span class="ruby-ivar">@validation_problems</span>[<span class="ruby-identifier">tte_id</span>] = <span class="ruby-identifier">errors</span>
360:       <span class="ruby-keyword kw">end</span>
361:     <span class="ruby-keyword kw">end</span>
362: 
363:     <span class="ruby-ivar">@timetable</span> = <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>)
364:     <span class="ruby-identifier">render</span> <span class="ruby-identifier">:partial</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;edit_tt_multiple2&quot;</span>
365:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000684" class="method-detail">
        <a name="M000684"></a>

        <div class="method-heading">
          <a href="#M000684" class="method-signature">
          <span class="method-name">update_timetable_view</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000684-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000684-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/timetable_controller.rb, line 242</span>
242:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update_timetable_view</span>
243:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:course_id</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
244:       <span class="ruby-identifier">render</span> <span class="ruby-identifier">:update</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">page</span><span class="ruby-operator">|</span>
245:         <span class="ruby-identifier">page</span>.<span class="ruby-identifier">replace_html</span> <span class="ruby-value str">&quot;timetable_view&quot;</span>, <span class="ruby-identifier">:text</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>
246:       <span class="ruby-keyword kw">end</span>
247:       <span class="ruby-keyword kw">return</span>
248:     <span class="ruby-keyword kw">end</span>
249:     <span class="ruby-ivar">@batch</span> = <span class="ruby-constant">Batch</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:course_id</span>])
250:     <span class="ruby-ivar">@timetable</span> = <span class="ruby-constant">TimetableEntry</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>)
251:     <span class="ruby-ivar">@class_timing</span> = <span class="ruby-constant">ClassTiming</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;is_break = false&quot;</span>)
252:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@class_timing</span>.<span class="ruby-identifier">empty?</span>
253:       <span class="ruby-ivar">@class_timing</span> = <span class="ruby-constant">ClassTiming</span>.<span class="ruby-identifier">default</span>
254:     <span class="ruby-keyword kw">end</span>
255:     <span class="ruby-ivar">@day</span> = <span class="ruby-constant">Weekday</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>)
256:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@day</span>.<span class="ruby-identifier">empty?</span>
257:       <span class="ruby-ivar">@day</span> = <span class="ruby-constant">Weekday</span>.<span class="ruby-identifier">default</span>
258:     <span class="ruby-keyword kw">end</span>
259: 
260:     <span class="ruby-ivar">@subjects</span> = <span class="ruby-constant">Subject</span>.<span class="ruby-identifier">find_all_by_batch_id</span>(<span class="ruby-ivar">@batch</span>.<span class="ruby-identifier">id</span>)
261:     <span class="ruby-ivar">@weekday</span> = [<span class="ruby-value str">&quot;Sun&quot;</span>, <span class="ruby-value str">&quot;Mon&quot;</span>, <span class="ruby-value str">&quot;Tue&quot;</span>, <span class="ruby-value str">&quot;Wed&quot;</span>, <span class="ruby-value str">&quot;Thu&quot;</span>, <span class="ruby-value str">&quot;Fri&quot;</span>, <span class="ruby-value str">&quot;Sat&quot;</span>]
262:     <span class="ruby-identifier">render</span> <span class="ruby-identifier">:update</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">page</span><span class="ruby-operator">|</span>
263:       <span class="ruby-identifier">page</span>.<span class="ruby-identifier">replace_html</span> <span class="ruby-value str">&quot;timetable_view&quot;</span>, <span class="ruby-identifier">:partial</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;view_timetable&quot;</span>
264:     <span class="ruby-keyword kw">end</span>
265:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000682" class="method-detail">
        <a name="M000682"></a>

        <div class="method-heading">
          <a href="#M000682" class="method-signature">
          <span class="method-name">view</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000682-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000682-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/timetable_controller.rb, line 222</span>
222:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">view</span>
223:     <span class="ruby-ivar">@courses</span> = <span class="ruby-constant">Batch</span>.<span class="ruby-identifier">active</span>
224:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000678" class="method-detail">
        <a name="M000678"></a>

        <div class="method-heading">
          <a href="#M000678" class="method-signature">
          <span class="method-name">weekdays</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000678-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000678-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/timetable_controller.rb, line 179</span>
179:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">weekdays</span>
180:     <span class="ruby-ivar">@batches</span> = <span class="ruby-constant">Batch</span>.<span class="ruby-identifier">active</span>
181:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>
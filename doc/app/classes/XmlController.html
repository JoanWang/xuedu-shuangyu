<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: XmlController</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">XmlController</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../files/app/controllers/xml_controller_rb.html">
                app/controllers/xml_controller.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="ApplicationController.html">
                ApplicationController
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">



   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000515">create_xml</a>&nbsp;&nbsp;
      <a href="#M000513">index</a>&nbsp;&nbsp;
      <a href="#M000514">settings</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000515" class="method-detail">
        <a name="M000515"></a>

        <div class="method-heading">
          <a href="#M000515" class="method-signature">
          <span class="method-name">create_xml</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
enevelope = REXML::Element.new &quot;ENVELOPE&quot;
</p>
<pre>
    header = enevelope.add_element &quot;HEADER&quot;
    tally_request = header.add_element &quot;TALLYREQUEST&quot;
    tally_request.text = &quot;Import Data&quot;
    body = enevelope.add_element &quot;BODY&quot;
    import_data = body.add_element &quot;IMPORTDATA&quot;
    requestdesc = import_data.add_element &quot;REQUESTDESC&quot;
    report_name = requestdesc.add_element &quot;REPORTNAME&quot;
    report_name.text = &quot;All Masters&quot;
    static_variables = requestdesc.add_element &quot;STATICVARIABLES&quot;
    svcurrentcompany = static_variables.add_element &quot;SVCURRENTCOMPANY&quot;
    svcurrentcompany.text = @institution.config_value
    requestdata = import_data.add_element &quot;REQUESTDATA&quot;

    while count&lt;2
      tally_message = requestdata.add_element &quot;TALLYMESSAGE&quot;
      currency = tally_message.add_element &quot;CURRENCY&quot;
      currency.add_attribute(&quot;NAME&quot;,@currency.config_value)
      currency.add_attribute(&quot;RESERVEDNAME&quot;,&quot;&quot;)
      additional_name = currency.add_element(&quot;ADDITIONALNAME&quot;)
      additional_name.text  = @currency.config_value
      expanded_name = currency.add_element(&quot;EXPANDEDSYMBOL&quot;)
      expanded_name.text = @currency.config_value
      decimal_symbol = currency.add_element(&quot;DECIMALNAME&quot;)
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000515-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000515-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/xml_controller.rb, line 44</span>
 44:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create_xml</span>
 45:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span>
 46:       <span class="ruby-ivar">@institution</span> = <span class="ruby-constant">Configuration</span>.<span class="ruby-identifier">find_by_config_key</span>(<span class="ruby-value str">&quot;InstitutionName&quot;</span>)
 47:       <span class="ruby-ivar">@currency</span> = <span class="ruby-constant">Configuration</span>.<span class="ruby-identifier">find_by_config_key</span>(<span class="ruby-value str">&quot;CurrencyType&quot;</span>)
 48:       <span class="ruby-ivar">@start_date</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:xml</span>][<span class="ruby-identifier">:start_date</span>].<span class="ruby-identifier">to_date</span>
 49:       <span class="ruby-ivar">@end_date</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:xml</span>][<span class="ruby-identifier">:end_date</span>].<span class="ruby-identifier">to_date</span>
 50:       <span class="ruby-identifier">employees</span> = <span class="ruby-constant">Employee</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>)
 51:       
 52:       <span class="ruby-ivar">@salaries</span> = []
 53:       <span class="ruby-ivar">@months</span> = <span class="ruby-constant">MonthlyPayslip</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:select</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;distinct salary_date&quot;</span> ,<span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'salary_date desc'</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-node">&quot;salary_date &gt;= '#{@start_date}' and salary_date &lt;= '#{@end_date}' and is_approved = 1&quot;</span>])
 54:       <span class="ruby-ivar">@months</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span>
 55:         <span class="ruby-ivar">@salary</span> = <span class="ruby-constant">Employee</span>.<span class="ruby-identifier">total_employees_salary</span>(<span class="ruby-identifier">employees</span>, <span class="ruby-identifier">m</span>.<span class="ruby-identifier">salary_date</span>, <span class="ruby-identifier">m</span>.<span class="ruby-identifier">salary_date</span>)
 56:         <span class="ruby-ivar">@salaries</span>.<span class="ruby-identifier">push</span> <span class="ruby-ivar">@salary</span>
 57:       <span class="ruby-keyword kw">end</span>
 58:       <span class="ruby-identifier">transactions</span> = <span class="ruby-constant">FinanceTransaction</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,
 59:         <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'created_at desc'</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-node">&quot;created_at &gt;= '#{@start_date}' and created_at &lt;= '#{@end_date}'&quot;</span>])
 60: 
 61:       <span class="ruby-identifier">count</span> = <span class="ruby-value">0</span>
 62:       <span class="ruby-identifier">category</span> = [<span class="ruby-value">1</span>,<span class="ruby-value">2</span>,<span class="ruby-value">3</span>]
 63:       <span class="ruby-identifier">file</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;Tally.xml&quot;</span>,<span class="ruby-value str">'w'</span>)
 64:       <span class="ruby-identifier">doc</span> = <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">Document</span>.<span class="ruby-identifier">new</span>
 65: 
 66:       <span class="ruby-identifier">enevelope</span> = <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">Element</span>.<span class="ruby-identifier">new</span> <span class="ruby-value str">&quot;ENVELOPE&quot;</span>
 67:       <span class="ruby-identifier">header</span> = <span class="ruby-identifier">enevelope</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;HEADER&quot;</span>
 68:       <span class="ruby-identifier">tally_request</span> = <span class="ruby-identifier">header</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;TALLYREQUEST&quot;</span>
 69:       <span class="ruby-identifier">tally_request</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;Import Data&quot;</span>
 70:       <span class="ruby-identifier">body</span> = <span class="ruby-identifier">enevelope</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;BODY&quot;</span>
 71:       <span class="ruby-identifier">import_data</span> = <span class="ruby-identifier">body</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;IMPORTDATA&quot;</span>
 72:       <span class="ruby-identifier">requestdesc</span> = <span class="ruby-identifier">import_data</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;REQUESTDESC&quot;</span>
 73:       <span class="ruby-identifier">report_name</span> = <span class="ruby-identifier">requestdesc</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;REPORTNAME&quot;</span>
 74:       <span class="ruby-identifier">report_name</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;All Masters&quot;</span>
 75:       <span class="ruby-identifier">static_variables</span> = <span class="ruby-identifier">requestdesc</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;STATICVARIABLES&quot;</span>
 76:       <span class="ruby-identifier">svcurrentcompany</span> = <span class="ruby-identifier">static_variables</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;SVCURRENTCOMPANY&quot;</span>
 77:       <span class="ruby-identifier">svcurrentcompany</span>.<span class="ruby-identifier">text</span> = <span class="ruby-ivar">@institution</span>.<span class="ruby-identifier">config_value</span>
 78:       <span class="ruby-identifier">requestdata</span> = <span class="ruby-identifier">import_data</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;REQUESTDATA&quot;</span>
 79:       <span class="ruby-identifier">transactions</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">trans</span><span class="ruby-operator">|</span>
 80:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">category</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">trans</span>.<span class="ruby-identifier">category_id</span>)
 81:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">trans</span>.<span class="ruby-identifier">category_id</span> <span class="ruby-operator">==</span> <span class="ruby-value">3</span>
 82:             <span class="ruby-identifier">fee</span> = <span class="ruby-constant">FinanceFee</span>.<span class="ruby-identifier">find_by_transaction_id</span>(<span class="ruby-identifier">trans</span>.<span class="ruby-identifier">id</span>)
 83:             <span class="ruby-identifier">student</span> = <span class="ruby-constant">Student</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">fee</span>.<span class="ruby-identifier">student_id</span>)
 84:             <span class="ruby-identifier">collection</span> = <span class="ruby-constant">FinanceFeeCollection</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">fee</span>.<span class="ruby-identifier">fee_collection_id</span>)
 85:             <span class="ruby-identifier">nar</span> = <span class="ruby-node">&quot;Fee recieved from #{student.full_name} for #{collection.name} - #{trans.title} &quot;</span>
 86:           <span class="ruby-keyword kw">else</span>
 87:             <span class="ruby-identifier">nar</span> = <span class="ruby-node">&quot;#{trans.title} - #{trans.description}&quot;</span>
 88:           <span class="ruby-keyword kw">end</span>
 89:           <span class="ruby-identifier">tally_message</span> = <span class="ruby-identifier">requestdata</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;TALLYMESSAGE&quot;</span>
 90:           <span class="ruby-identifier">tally_message</span>.<span class="ruby-identifier">add_attribute</span>(<span class="ruby-value str">&quot;xmlns:UDF&quot;</span>,<span class="ruby-value str">&quot;TallyUDF&quot;</span>)
 91:           <span class="ruby-identifier">count</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
 92:      
 93:           <span class="ruby-ivar">@ledger</span> = <span class="ruby-constant">Xml</span>.<span class="ruby-identifier">find_by_finance_name</span>(<span class="ruby-identifier">trans</span>.<span class="ruby-identifier">category</span>.<span class="ruby-identifier">name</span>)
 94:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">trans</span>.<span class="ruby-identifier">category</span>.<span class="ruby-identifier">is_income?</span>
 95:             <span class="ruby-identifier">voucher</span> = <span class="ruby-identifier">tally_message</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;VOUCHER&quot;</span>
 96:             <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_attribute</span>(<span class="ruby-value str">&quot;REMOTEID&quot;</span>,<span class="ruby-value str">&quot;&quot;</span>)
 97:             <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_attribute</span>(<span class="ruby-value str">&quot;VCHTYPE&quot;</span>,<span class="ruby-value str">&quot;Receipt&quot;</span>)
 98:             <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_attribute</span>(<span class="ruby-value str">&quot;ACTION&quot;</span>,<span class="ruby-value str">&quot;Create&quot;</span>)
 99:             <span class="ruby-identifier">date</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;DATE&quot;</span>
100:             <span class="ruby-identifier">date</span>.<span class="ruby-identifier">text</span> = <span class="ruby-identifier">trans</span>.<span class="ruby-identifier">created_at</span>.<span class="ruby-identifier">strftime</span>(<span class="ruby-value str">&quot;%Y%m%d&quot;</span>)
101:             <span class="ruby-comment cmt">#            date.text = &quot;20090901&quot;</span>
102:             <span class="ruby-identifier">guid</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;GUID&quot;</span>
103:             <span class="ruby-identifier">guid</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;&quot;</span>
104:             <span class="ruby-identifier">narration</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;NARRATION&quot;</span>
105:             <span class="ruby-identifier">narration</span>.<span class="ruby-identifier">text</span> = <span class="ruby-node">&quot;#{nar}&quot;</span>
106:             <span class="ruby-identifier">vouchertype</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;VOUCHERTYPENAME&quot;</span>
107:             <span class="ruby-identifier">vouchertype</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;Receipt&quot;</span>
108:             <span class="ruby-identifier">vouchernumber</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;VOUCHERNUMBER&quot;</span>
109:             <span class="ruby-identifier">vouchernumber</span>.<span class="ruby-identifier">text</span> = <span class="ruby-identifier">count</span>
110:             <span class="ruby-identifier">partyledgername</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;PARTYLEDGERNAME&quot;</span>
111:             <span class="ruby-identifier">partyledgername</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;Cash&quot;</span>
112:             <span class="ruby-identifier">form_issue_type</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;CSTFORMISSUETYPE&quot;</span>
113:             <span class="ruby-identifier">form_rcv_type</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;CSTFORMRECVTYPE&quot;</span>
114:             <span class="ruby-identifier">paymnt_type</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;FBTPAYMENTTYPE&quot;</span>
115:             <span class="ruby-identifier">paymnt_type</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;Default&quot;</span>
116:             <span class="ruby-identifier">gst_class</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;VCHGSTCLASS&quot;</span>
117:             <span class="ruby-identifier">actual_qty</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;DIFFACTUALQTY&quot;</span>
118:             <span class="ruby-identifier">actual_qty</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
119:             <span class="ruby-identifier">audited</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;AUDITED&quot;</span>
120:             <span class="ruby-identifier">audited</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
121:             <span class="ruby-identifier">job_costing</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;FORJOBCOSTING&quot;</span>
122:             <span class="ruby-identifier">job_costing</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
123:             <span class="ruby-identifier">is_optional</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISOPTIONAL&quot;</span>
124:             <span class="ruby-identifier">is_optional</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
125:             <span class="ruby-identifier">effective_date</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;EFFECTIVEDATE&quot;</span>
126:             <span class="ruby-identifier">effective_date</span>.<span class="ruby-identifier">text</span> = <span class="ruby-identifier">trans</span>.<span class="ruby-identifier">created_at</span>.<span class="ruby-identifier">strftime</span>(<span class="ruby-value str">&quot;%Y%m%d&quot;</span>)
127:             <span class="ruby-comment cmt">#            effective_date.text = &quot;20090901&quot;</span>
128:             <span class="ruby-identifier">use_for_interest</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;USEFORINTEREST&quot;</span>
129:             <span class="ruby-identifier">use_for_interest</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
130:             <span class="ruby-identifier">use_for_gain_loss</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;USEFORGAINLOSS&quot;</span>
131:             <span class="ruby-identifier">use_for_gain_loss</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
132:             <span class="ruby-identifier">use_for_godown_transfer</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;USEFORGODOWNTRANSFER&quot;</span>
133:             <span class="ruby-identifier">use_for_godown_transfer</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
134:             <span class="ruby-identifier">use_for_compound</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;USEFORCOMPOUND&quot;</span>
135:             <span class="ruby-identifier">use_for_compound</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
136:             <span class="ruby-identifier">alter_id</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ALTERID&quot;</span>
137:             <span class="ruby-identifier">alter_id</span>.<span class="ruby-identifier">text</span> = <span class="ruby-identifier">count</span>
138:             <span class="ruby-identifier">excise_opening</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;EXCISEOPENING&quot;</span>
139:             <span class="ruby-identifier">excise_opening</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
140:             <span class="ruby-identifier">is_cancelled</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISCANCELLED&quot;</span>
141:             <span class="ruby-identifier">is_cancelled</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
142:             <span class="ruby-identifier">has_cash_flow</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;HASCASHFLOW&quot;</span>
143:             <span class="ruby-identifier">has_cash_flow</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;Yes&quot;</span>
144:             <span class="ruby-identifier">is_posted_date</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISPOSTDATED&quot;</span>
145:             <span class="ruby-identifier">is_posted_date</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
146:             <span class="ruby-identifier">use_tracking_number</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;USETRACKINGNUMBER&quot;</span>
147:             <span class="ruby-identifier">use_tracking_number</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
148:             <span class="ruby-identifier">is_invoice</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISINVOICE&quot;</span>
149:             <span class="ruby-identifier">is_invoice</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
150:             <span class="ruby-identifier">mfg_journal</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;MFGJOURNAL&quot;</span>
151:             <span class="ruby-identifier">mfg_journal</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
152:             <span class="ruby-identifier">has_discounts</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;HASDISCOUNTS&quot;</span>
153:             <span class="ruby-identifier">has_discounts</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
154:             <span class="ruby-identifier">as_payslip</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ASPAYSLIP&quot;</span>
155:             <span class="ruby-identifier">as_payslip</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
156:             <span class="ruby-identifier">is_deleted</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISDELETED&quot;</span>
157:             <span class="ruby-identifier">is_deleted</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
158:             <span class="ruby-identifier">as_original</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ASORIGINAL&quot;</span>
159:             <span class="ruby-identifier">as_original</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
160:             <span class="ruby-identifier">all_ledger_entry</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ALLLEDGERENTRIES.LIST&quot;</span>
161:             <span class="ruby-identifier">ledger_name</span> = <span class="ruby-identifier">all_ledger_entry</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;LEDGERNAME&quot;</span>
162:             <span class="ruby-identifier">ledger_name</span>.<span class="ruby-identifier">text</span> = <span class="ruby-ivar">@ledger</span>.<span class="ruby-identifier">ledger_name</span>
163:             <span class="ruby-identifier">gst_class</span> = <span class="ruby-identifier">all_ledger_entry</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;GSTCLASS&quot;</span>
164:             <span class="ruby-identifier">is_deemed_positive</span> = <span class="ruby-identifier">all_ledger_entry</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISDEEMEDPOSITIVE&quot;</span>
165:             <span class="ruby-identifier">is_deemed_positive</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
166:             <span class="ruby-identifier">ledger_from_item</span> = <span class="ruby-identifier">all_ledger_entry</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;LEDGERFROMITEM&quot;</span>
167:             <span class="ruby-identifier">ledger_from_item</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
168:             <span class="ruby-identifier">remove_zero_entries</span> = <span class="ruby-identifier">all_ledger_entry</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;REMOVEZEROENTRIES&quot;</span>
169:             <span class="ruby-identifier">remove_zero_entries</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
170:             <span class="ruby-identifier">is_party_ledger</span> = <span class="ruby-identifier">all_ledger_entry</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISPARTYLEDGER&quot;</span>
171:             <span class="ruby-identifier">is_party_ledger</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
172:             <span class="ruby-identifier">amount</span> = <span class="ruby-identifier">all_ledger_entry</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;AMOUNT&quot;</span>
173:             <span class="ruby-identifier">amount</span>.<span class="ruby-identifier">text</span> = <span class="ruby-node">&quot;#{trans.amount}&quot;</span>
174:             <span class="ruby-identifier">all_ledger_entry2</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ALLLEDGERENTRIES.LIST&quot;</span>
175:             <span class="ruby-identifier">ledger_name2</span> = <span class="ruby-identifier">all_ledger_entry2</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;LEDGERNAME&quot;</span>
176:             <span class="ruby-identifier">ledger_name2</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;Cash&quot;</span>
177:             <span class="ruby-identifier">gst_class2</span> = <span class="ruby-identifier">all_ledger_entry2</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;GSTCLASS&quot;</span>
178:             <span class="ruby-identifier">is_deemed_positive2</span> = <span class="ruby-identifier">all_ledger_entry2</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISDEEMEDPOSITIVE&quot;</span>
179:             <span class="ruby-identifier">is_deemed_positive2</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;Yes&quot;</span>
180:             <span class="ruby-identifier">ledger_from_item2</span> = <span class="ruby-identifier">all_ledger_entry2</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;LEDGERFROMITEM&quot;</span>
181:             <span class="ruby-identifier">ledger_from_item2</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
182:             <span class="ruby-identifier">remove_zero_entries2</span> = <span class="ruby-identifier">all_ledger_entry2</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;REMOVEZEROENTRIES&quot;</span>
183:             <span class="ruby-identifier">remove_zero_entries2</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
184:             <span class="ruby-identifier">is_party_ledger2</span> = <span class="ruby-identifier">all_ledger_entry2</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISPARTYLEDGER&quot;</span>
185:             <span class="ruby-identifier">is_party_ledger2</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;Yes&quot;</span>
186:             <span class="ruby-identifier">amount2</span> = <span class="ruby-identifier">all_ledger_entry2</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;AMOUNT&quot;</span>
187:             <span class="ruby-identifier">amount2</span>.<span class="ruby-identifier">text</span> = <span class="ruby-node">&quot;-#{trans.amount}&quot;</span>
188: 
189:             <span class="ruby-comment cmt">#            account = enevelope.add_element &quot;DSPVCHLEDACCOUNT&quot;</span>
190:             <span class="ruby-comment cmt">#            account.text = @ledger.ledger_name</span>
191:             <span class="ruby-comment cmt">#            namefield = enevelope.add_element &quot;NAMEFIELD&quot;</span>
192:             <span class="ruby-comment cmt">#            infofield = enevelope.add_element &quot;INFOFIELD&quot;</span>
193:             <span class="ruby-comment cmt">#            vouchertype = enevelope.add_element &quot;DSPVCHTYPE&quot;</span>
194:             <span class="ruby-comment cmt">#            vouchertype.text = &quot;Rcpt&quot;</span>
195:             <span class="ruby-comment cmt">#            voucheramt = enevelope.add_element &quot;DSPVCHDRAMT&quot;</span>
196:             <span class="ruby-comment cmt">#            voucheramt.text = &quot;-#{trans.amount}&quot;</span>
197:             <span class="ruby-comment cmt">#            voucheramt = enevelope.add_element &quot;DSPVCHDRAMT&quot;</span>
198:           <span class="ruby-keyword kw">else</span>
199:             <span class="ruby-identifier">voucher</span> = <span class="ruby-identifier">tally_message</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;VOUCHER&quot;</span>
200:             <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_attribute</span>(<span class="ruby-value str">&quot;REMOTEID&quot;</span>,<span class="ruby-value str">&quot;&quot;</span>)
201:             <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_attribute</span>(<span class="ruby-value str">&quot;VCHTYPE&quot;</span>,<span class="ruby-value str">&quot;Payment&quot;</span>)
202:             <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_attribute</span>(<span class="ruby-value str">&quot;ACTION&quot;</span>,<span class="ruby-value str">&quot;Create&quot;</span>)
203:             <span class="ruby-identifier">date</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;DATE&quot;</span>
204:             <span class="ruby-identifier">date</span>.<span class="ruby-identifier">text</span> = <span class="ruby-identifier">trans</span>.<span class="ruby-identifier">created_at</span>.<span class="ruby-identifier">strftime</span>(<span class="ruby-value str">&quot;%Y%m%d&quot;</span>)
205:             <span class="ruby-comment cmt">#            date.text = &quot;20090901&quot;</span>
206:             <span class="ruby-identifier">guid</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;GUID&quot;</span>
207:             <span class="ruby-identifier">guid</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;&quot;</span>
208:             <span class="ruby-identifier">narration</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;NARRATION&quot;</span>
209:             <span class="ruby-identifier">narration</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;&quot;</span>
210:             <span class="ruby-identifier">vouchertype</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;VOUCHERTYPENAME&quot;</span>
211:             <span class="ruby-identifier">vouchertype</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;Payment&quot;</span>
212:             <span class="ruby-identifier">vouchernumber</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;VOUCHERNUMBER&quot;</span>
213:             <span class="ruby-identifier">vouchernumber</span>.<span class="ruby-identifier">text</span> = <span class="ruby-identifier">i</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>
214:             <span class="ruby-identifier">partyledgername</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;PARTYLEDGERNAME&quot;</span>
215:             <span class="ruby-identifier">partyledgername</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;Cash&quot;</span>
216:             <span class="ruby-identifier">form_issue_type</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;CSTFORMISSUETYPE&quot;</span>
217:             <span class="ruby-identifier">form_rcv_type</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;CSTFORMRECVTYPE&quot;</span>
218:             <span class="ruby-identifier">paymnt_type</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;FBTPAYMENTTYPE&quot;</span>
219:             <span class="ruby-identifier">paymnt_type</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;Default&quot;</span>
220:             <span class="ruby-identifier">gst_class</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;VCHGSTCLASS&quot;</span>
221:             <span class="ruby-identifier">actual_qty</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;DIFFACTUALQTY&quot;</span>
222:             <span class="ruby-identifier">actual_qty</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
223:             <span class="ruby-identifier">audited</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;AUDITED&quot;</span>
224:             <span class="ruby-identifier">audited</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
225:             <span class="ruby-identifier">job_costing</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;FORJOBCOSTING&quot;</span>
226:             <span class="ruby-identifier">job_costing</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
227:             <span class="ruby-identifier">is_optional</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISOPTIONAL&quot;</span>
228:             <span class="ruby-identifier">is_optional</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
229:             <span class="ruby-identifier">effective_date</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;EFFECTIVEDATE&quot;</span>
230:             <span class="ruby-identifier">effective_date</span>.<span class="ruby-identifier">text</span> = <span class="ruby-identifier">trans</span>.<span class="ruby-identifier">created_at</span>.<span class="ruby-identifier">strftime</span>(<span class="ruby-value str">&quot;%Y%m%d&quot;</span>)
231:             <span class="ruby-comment cmt">#            effective_date.text = &quot;20090901&quot;</span>
232:             <span class="ruby-identifier">use_for_interest</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;USEFORINTEREST&quot;</span>
233:             <span class="ruby-identifier">use_for_interest</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
234:             <span class="ruby-identifier">use_for_gain_loss</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;USEFORGAINLOSS&quot;</span>
235:             <span class="ruby-identifier">use_for_gain_loss</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
236:             <span class="ruby-identifier">use_for_godown_transfer</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;USEFORGODOWNTRANSFER&quot;</span>
237:             <span class="ruby-identifier">use_for_godown_transfer</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
238:             <span class="ruby-identifier">use_for_compound</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;USEFORCOMPOUND&quot;</span>
239:             <span class="ruby-identifier">use_for_compound</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
240:             <span class="ruby-identifier">alter_id</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ALTERID&quot;</span>
241:             <span class="ruby-identifier">alter_id</span>.<span class="ruby-identifier">text</span> = <span class="ruby-identifier">i</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>
242:             <span class="ruby-identifier">excise_opening</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;EXCISEOPENING&quot;</span>
243:             <span class="ruby-identifier">excise_opening</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
244:             <span class="ruby-identifier">is_cancelled</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISCANCELLED&quot;</span>
245:             <span class="ruby-identifier">is_cancelled</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
246:             <span class="ruby-identifier">has_cash_flow</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;HASCASHFLOW&quot;</span>
247:             <span class="ruby-identifier">has_cash_flow</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;Yes&quot;</span>
248:             <span class="ruby-identifier">is_posted_date</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISPOSTDATED&quot;</span>
249:             <span class="ruby-identifier">is_posted_date</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
250:             <span class="ruby-identifier">use_tracking_number</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;USETRACKINGNUMBER&quot;</span>
251:             <span class="ruby-identifier">use_tracking_number</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
252:             <span class="ruby-identifier">is_invoice</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISINVOICE&quot;</span>
253:             <span class="ruby-identifier">is_invoice</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
254:             <span class="ruby-identifier">mfg_journal</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;MFGJOURNAL&quot;</span>
255:             <span class="ruby-identifier">mfg_journal</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
256:             <span class="ruby-identifier">has_discounts</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;HASDISCOUNTS&quot;</span>
257:             <span class="ruby-identifier">has_discounts</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
258:             <span class="ruby-identifier">as_payslip</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ASPAYSLIP&quot;</span>
259:             <span class="ruby-identifier">as_payslip</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
260:             <span class="ruby-identifier">is_deleted</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISDELETED&quot;</span>
261:             <span class="ruby-identifier">is_deleted</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
262:             <span class="ruby-identifier">as_original</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ASORIGINAL&quot;</span>
263:             <span class="ruby-identifier">as_original</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
264:             <span class="ruby-identifier">all_ledger_entry</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ALLLEDGERENTRIES.LIST&quot;</span>
265:             <span class="ruby-identifier">ledger_name</span> = <span class="ruby-identifier">all_ledger_entry</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;LEDGERNAME&quot;</span>
266:             <span class="ruby-identifier">ledger_name</span>.<span class="ruby-identifier">text</span> = <span class="ruby-ivar">@ledger</span>.<span class="ruby-identifier">ledger_name</span>
267:             <span class="ruby-identifier">gst_class</span> = <span class="ruby-identifier">all_ledger_entry</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;GSTCLASS&quot;</span>
268:             <span class="ruby-identifier">is_deemed_positive</span> = <span class="ruby-identifier">all_ledger_entry</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISDEEMEDPOSITIVE&quot;</span>
269:             <span class="ruby-identifier">is_deemed_positive</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
270:             <span class="ruby-identifier">ledger_from_item</span> = <span class="ruby-identifier">all_ledger_entry</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;LEDGERFROMITEM&quot;</span>
271:             <span class="ruby-identifier">ledger_from_item</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
272:             <span class="ruby-identifier">remove_zero_entries</span> = <span class="ruby-identifier">all_ledger_entry</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;REMOVEZEROENTRIES&quot;</span>
273:             <span class="ruby-identifier">remove_zero_entries</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
274:             <span class="ruby-identifier">is_party_ledger</span> = <span class="ruby-identifier">all_ledger_entry</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISPARTYLEDGER&quot;</span>
275:             <span class="ruby-identifier">is_party_ledger</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
276:             <span class="ruby-identifier">amount</span> = <span class="ruby-identifier">all_ledger_entry</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;AMOUNT&quot;</span>
277:             <span class="ruby-identifier">amount</span>.<span class="ruby-identifier">text</span> = <span class="ruby-node">&quot;-#{trans.amount}&quot;</span>
278:             <span class="ruby-identifier">all_ledger_entry2</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ALLLEDGERENTRIES.LIST&quot;</span>
279:             <span class="ruby-identifier">ledger_name2</span> = <span class="ruby-identifier">all_ledger_entry2</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;LEDGERNAME&quot;</span>
280:             <span class="ruby-identifier">ledger_name2</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;Cash&quot;</span>
281:             <span class="ruby-identifier">gst_class2</span> = <span class="ruby-identifier">all_ledger_entry2</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;GSTCLASS&quot;</span>
282:             <span class="ruby-identifier">is_deemed_positive2</span> = <span class="ruby-identifier">all_ledger_entry2</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISDEEMEDPOSITIVE&quot;</span>
283:             <span class="ruby-identifier">is_deemed_positive2</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;Yes&quot;</span>
284:             <span class="ruby-identifier">ledger_from_item2</span> = <span class="ruby-identifier">all_ledger_entry2</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;LEDGERFROMITEM&quot;</span>
285:             <span class="ruby-identifier">ledger_from_item2</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
286:             <span class="ruby-identifier">remove_zero_entries2</span> = <span class="ruby-identifier">all_ledger_entry2</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;REMOVEZEROENTRIES&quot;</span>
287:             <span class="ruby-identifier">remove_zero_entries2</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
288:             <span class="ruby-identifier">is_party_ledger2</span> = <span class="ruby-identifier">all_ledger_entry2</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISPARTYLEDGER&quot;</span>
289:             <span class="ruby-identifier">is_party_ledger2</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;Yes&quot;</span>
290:             <span class="ruby-identifier">amount2</span> = <span class="ruby-identifier">all_ledger_entry2</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;AMOUNT&quot;</span>
291:             <span class="ruby-identifier">amount2</span>.<span class="ruby-identifier">text</span> = <span class="ruby-node">&quot;#{trans.amount}&quot;</span>
292:             <span class="ruby-comment cmt">#            date = enevelope.add_element &quot;DSPVCHDATE&quot;</span>
293:             <span class="ruby-comment cmt">#            date.text = trans.created_at.strftime(&quot;%d-%m-%y&quot;)</span>
294:             <span class="ruby-comment cmt">#            account = enevelope.add_element &quot;DSPVCHLEDACCOUNT&quot;</span>
295:             <span class="ruby-comment cmt">#            account.text = @ledger.ledger_name</span>
296:             <span class="ruby-comment cmt">#            namefield = enevelope.add_element &quot;NAMEFIELD&quot;</span>
297:             <span class="ruby-comment cmt">#            infofield = enevelope.add_element &quot;INFOFIELD&quot;</span>
298:             <span class="ruby-comment cmt">#            vouchertype = enevelope.add_element &quot;DSPVCHTYPE&quot;</span>
299:             <span class="ruby-comment cmt">#            vouchertype.text = &quot;Pymt&quot;</span>
300:             <span class="ruby-comment cmt">#            voucheramt = enevelope.add_element &quot;DSPVCHDRAMT&quot;</span>
301:             <span class="ruby-comment cmt">#            voucheramt.text = trans.amount</span>
302:             <span class="ruby-comment cmt">#            voucheramt = enevelope.add_element &quot;DSPVCHDRAMT&quot;</span>
303:           <span class="ruby-keyword kw">end</span>
304:         <span class="ruby-keyword kw">end</span>
305:       <span class="ruby-keyword kw">end</span>
306:       <span class="ruby-ivar">@salaries</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span>
307:         <span class="ruby-identifier">count</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
308:         <span class="ruby-ivar">@ledger</span> = <span class="ruby-constant">Xml</span>.<span class="ruby-identifier">find_by_finance_name</span>(<span class="ruby-value str">&quot;Salary&quot;</span>)
309:         <span class="ruby-identifier">tally_message</span> = <span class="ruby-identifier">requestdata</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;TALLYMESSAGE&quot;</span>
310:         <span class="ruby-identifier">tally_message</span>.<span class="ruby-identifier">add_attribute</span>(<span class="ruby-value str">&quot;xmlns:UDF&quot;</span>,<span class="ruby-value str">&quot;TallyUDF&quot;</span>)
311:         <span class="ruby-identifier">voucher</span> = <span class="ruby-identifier">tally_message</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;VOUCHER&quot;</span>
312:         <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_attribute</span>(<span class="ruby-value str">&quot;REMOTEID&quot;</span>,<span class="ruby-value str">&quot;&quot;</span>)
313:         <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_attribute</span>(<span class="ruby-value str">&quot;VCHTYPE&quot;</span>,<span class="ruby-value str">&quot;Payment&quot;</span>)
314:         <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_attribute</span>(<span class="ruby-value str">&quot;ACTION&quot;</span>,<span class="ruby-value str">&quot;Create&quot;</span>)
315:         <span class="ruby-identifier">date</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;DATE&quot;</span>
316:         <span class="ruby-identifier">date</span>.<span class="ruby-identifier">text</span> = <span class="ruby-ivar">@start_date</span>.<span class="ruby-identifier">beginning_of_month</span>.<span class="ruby-identifier">strftime</span>(<span class="ruby-value str">&quot;%Y%m%d&quot;</span>)
317:         <span class="ruby-comment cmt">#            date.text = &quot;20090901&quot;</span>
318:         <span class="ruby-identifier">guid</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;GUID&quot;</span>
319:         <span class="ruby-identifier">guid</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;&quot;</span>
320:         <span class="ruby-identifier">narration</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;NARRATION&quot;</span>
321:         <span class="ruby-identifier">narration</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;Salary given&quot;</span>
322:         <span class="ruby-identifier">vouchertype</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;VOUCHERTYPENAME&quot;</span>
323:         <span class="ruby-identifier">vouchertype</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;Payment&quot;</span>
324:         <span class="ruby-identifier">vouchernumber</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;VOUCHERNUMBER&quot;</span>
325:         <span class="ruby-identifier">vouchernumber</span>.<span class="ruby-identifier">text</span> = <span class="ruby-identifier">count</span>
326:         <span class="ruby-identifier">partyledgername</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;PARTYLEDGERNAME&quot;</span>
327:         <span class="ruby-identifier">partyledgername</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;Cash&quot;</span>
328:         <span class="ruby-identifier">form_issue_type</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;CSTFORMISSUETYPE&quot;</span>
329:         <span class="ruby-identifier">form_rcv_type</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;CSTFORMRECVTYPE&quot;</span>
330:         <span class="ruby-identifier">paymnt_type</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;FBTPAYMENTTYPE&quot;</span>
331:         <span class="ruby-identifier">paymnt_type</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;Default&quot;</span>
332:         <span class="ruby-identifier">gst_class</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;VCHGSTCLASS&quot;</span>
333:         <span class="ruby-identifier">actual_qty</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;DIFFACTUALQTY&quot;</span>
334:         <span class="ruby-identifier">actual_qty</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
335:         <span class="ruby-identifier">audited</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;AUDITED&quot;</span>
336:         <span class="ruby-identifier">audited</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
337:         <span class="ruby-identifier">job_costing</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;FORJOBCOSTING&quot;</span>
338:         <span class="ruby-identifier">job_costing</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
339:         <span class="ruby-identifier">is_optional</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISOPTIONAL&quot;</span>
340:         <span class="ruby-identifier">is_optional</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
341:         <span class="ruby-identifier">effective_date</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;EFFECTIVEDATE&quot;</span>
342:         <span class="ruby-identifier">effective_date</span>.<span class="ruby-identifier">text</span> = <span class="ruby-ivar">@start_date</span>.<span class="ruby-identifier">beginning_of_month</span>.<span class="ruby-identifier">strftime</span>(<span class="ruby-value str">&quot;%Y%m%d&quot;</span>)
343:         <span class="ruby-comment cmt">#            effective_date.text = &quot;20090901&quot;</span>
344:         <span class="ruby-identifier">use_for_interest</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;USEFORINTEREST&quot;</span>
345:         <span class="ruby-identifier">use_for_interest</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
346:         <span class="ruby-identifier">use_for_gain_loss</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;USEFORGAINLOSS&quot;</span>
347:         <span class="ruby-identifier">use_for_gain_loss</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
348:         <span class="ruby-identifier">use_for_godown_transfer</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;USEFORGODOWNTRANSFER&quot;</span>
349:         <span class="ruby-identifier">use_for_godown_transfer</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
350:         <span class="ruby-identifier">use_for_compound</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;USEFORCOMPOUND&quot;</span>
351:         <span class="ruby-identifier">use_for_compound</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
352:         <span class="ruby-identifier">alter_id</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ALTERID&quot;</span>
353:         <span class="ruby-identifier">alter_id</span>.<span class="ruby-identifier">text</span> = <span class="ruby-identifier">count</span>
354:         <span class="ruby-identifier">excise_opening</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;EXCISEOPENING&quot;</span>
355:         <span class="ruby-identifier">excise_opening</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
356:         <span class="ruby-identifier">is_cancelled</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISCANCELLED&quot;</span>
357:         <span class="ruby-identifier">is_cancelled</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
358:         <span class="ruby-identifier">has_cash_flow</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;HASCASHFLOW&quot;</span>
359:         <span class="ruby-identifier">has_cash_flow</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;Yes&quot;</span>
360:         <span class="ruby-identifier">is_posted_date</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISPOSTDATED&quot;</span>
361:         <span class="ruby-identifier">is_posted_date</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
362:         <span class="ruby-identifier">use_tracking_number</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;USETRACKINGNUMBER&quot;</span>
363:         <span class="ruby-identifier">use_tracking_number</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
364:         <span class="ruby-identifier">is_invoice</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISINVOICE&quot;</span>
365:         <span class="ruby-identifier">is_invoice</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
366:         <span class="ruby-identifier">mfg_journal</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;MFGJOURNAL&quot;</span>
367:         <span class="ruby-identifier">mfg_journal</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
368:         <span class="ruby-identifier">has_discounts</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;HASDISCOUNTS&quot;</span>
369:         <span class="ruby-identifier">has_discounts</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
370:         <span class="ruby-identifier">as_payslip</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ASPAYSLIP&quot;</span>
371:         <span class="ruby-identifier">as_payslip</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
372:         <span class="ruby-identifier">is_deleted</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISDELETED&quot;</span>
373:         <span class="ruby-identifier">is_deleted</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
374:         <span class="ruby-identifier">as_original</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ASORIGINAL&quot;</span>
375:         <span class="ruby-identifier">as_original</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
376:         <span class="ruby-identifier">all_ledger_entry</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ALLLEDGERENTRIES.LIST&quot;</span>
377:         <span class="ruby-identifier">ledger_name</span> = <span class="ruby-identifier">all_ledger_entry</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;LEDGERNAME&quot;</span>
378:         <span class="ruby-identifier">ledger_name</span>.<span class="ruby-identifier">text</span> = <span class="ruby-ivar">@ledger</span>.<span class="ruby-identifier">ledger_name</span>
379:         <span class="ruby-identifier">gst_class</span> = <span class="ruby-identifier">all_ledger_entry</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;GSTCLASS&quot;</span>
380:         <span class="ruby-identifier">is_deemed_positive</span> = <span class="ruby-identifier">all_ledger_entry</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISDEEMEDPOSITIVE&quot;</span>
381:         <span class="ruby-identifier">is_deemed_positive</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
382:         <span class="ruby-identifier">ledger_from_item</span> = <span class="ruby-identifier">all_ledger_entry</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;LEDGERFROMITEM&quot;</span>
383:         <span class="ruby-identifier">ledger_from_item</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
384:         <span class="ruby-identifier">remove_zero_entries</span> = <span class="ruby-identifier">all_ledger_entry</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;REMOVEZEROENTRIES&quot;</span>
385:         <span class="ruby-identifier">remove_zero_entries</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
386:         <span class="ruby-identifier">is_party_ledger</span> = <span class="ruby-identifier">all_ledger_entry</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISPARTYLEDGER&quot;</span>
387:         <span class="ruby-identifier">is_party_ledger</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
388:         <span class="ruby-identifier">amount</span> = <span class="ruby-identifier">all_ledger_entry</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;AMOUNT&quot;</span>
389:         <span class="ruby-identifier">amount</span>.<span class="ruby-identifier">text</span> = <span class="ruby-node">&quot;-#{s}&quot;</span>
390:         <span class="ruby-identifier">all_ledger_entry2</span> = <span class="ruby-identifier">voucher</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ALLLEDGERENTRIES.LIST&quot;</span>
391:         <span class="ruby-identifier">ledger_name2</span> = <span class="ruby-identifier">all_ledger_entry2</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;LEDGERNAME&quot;</span>
392:         <span class="ruby-identifier">ledger_name2</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;Cash&quot;</span>
393:         <span class="ruby-identifier">gst_class2</span> = <span class="ruby-identifier">all_ledger_entry2</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;GSTCLASS&quot;</span>
394:         <span class="ruby-identifier">is_deemed_positive2</span> = <span class="ruby-identifier">all_ledger_entry2</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISDEEMEDPOSITIVE&quot;</span>
395:         <span class="ruby-identifier">is_deemed_positive2</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;Yes&quot;</span>
396:         <span class="ruby-identifier">ledger_from_item2</span> = <span class="ruby-identifier">all_ledger_entry2</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;LEDGERFROMITEM&quot;</span>
397:         <span class="ruby-identifier">ledger_from_item2</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
398:         <span class="ruby-identifier">remove_zero_entries2</span> = <span class="ruby-identifier">all_ledger_entry2</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;REMOVEZEROENTRIES&quot;</span>
399:         <span class="ruby-identifier">remove_zero_entries2</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;No&quot;</span>
400:         <span class="ruby-identifier">is_party_ledger2</span> = <span class="ruby-identifier">all_ledger_entry2</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;ISPARTYLEDGER&quot;</span>
401:         <span class="ruby-identifier">is_party_ledger2</span>.<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;Yes&quot;</span>
402:         <span class="ruby-identifier">amount2</span> = <span class="ruby-identifier">all_ledger_entry2</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-value str">&quot;AMOUNT&quot;</span>
403:         <span class="ruby-identifier">amount2</span>.<span class="ruby-identifier">text</span> = <span class="ruby-node">&quot;#{s}&quot;</span>
404:         <span class="ruby-comment cmt">#        date = enevelope.add_element &quot;DSPVCHDATE&quot;</span>
405:         <span class="ruby-comment cmt">#        date.text = @start_date.beginning_of_month.strftime(&quot;%d-%m-%y&quot;)</span>
406:         <span class="ruby-comment cmt">#        account = enevelope.add_element &quot;DSPVCHLEDACCOUNT&quot;</span>
407:         <span class="ruby-comment cmt">#        account.text = @ledger.ledger_name</span>
408:         <span class="ruby-comment cmt">#        namefield = enevelope.add_element &quot;NAMEFIELD&quot;</span>
409:         <span class="ruby-comment cmt">#        infofield = enevelope.add_element &quot;INFOFIELD&quot;</span>
410:         <span class="ruby-comment cmt">#        vouchertype = enevelope.add_element &quot;DSPVCHTYPE&quot;</span>
411:         <span class="ruby-comment cmt">#        vouchertype.text = &quot;Pymt&quot;</span>
412:         <span class="ruby-comment cmt">#        voucheramt = enevelope.add_element &quot;DSPVCHDRAMT&quot;</span>
413:         <span class="ruby-comment cmt">#        voucheramt.text = s</span>
414:         <span class="ruby-comment cmt">#        voucheramt = enevelope.add_element &quot;DSPVCHDRAMT&quot;</span>
415:         <span class="ruby-ivar">@start_date</span> = <span class="ruby-ivar">@start_date</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>.<span class="ruby-identifier">month</span>
416:       <span class="ruby-keyword kw">end</span>
417:     
418:       <span class="ruby-comment cmt">#    enevelope = REXML::Element.new &quot;ENVELOPE&quot;</span>
419:       <span class="ruby-comment cmt">#    header = enevelope.add_element &quot;HEADER&quot;</span>
420:       <span class="ruby-comment cmt">#    tally_request = header.add_element &quot;TALLYREQUEST&quot;</span>
421:       <span class="ruby-comment cmt">#    tally_request.text = &quot;Import Data&quot;</span>
422:       <span class="ruby-comment cmt">#    body = enevelope.add_element &quot;BODY&quot;</span>
423:       <span class="ruby-comment cmt">#    import_data = body.add_element &quot;IMPORTDATA&quot;</span>
424:       <span class="ruby-comment cmt">#    requestdesc = import_data.add_element &quot;REQUESTDESC&quot;</span>
425:       <span class="ruby-comment cmt">#    report_name = requestdesc.add_element &quot;REPORTNAME&quot;</span>
426:       <span class="ruby-comment cmt">#    report_name.text = &quot;All Masters&quot;</span>
427:       <span class="ruby-comment cmt">#    static_variables = requestdesc.add_element &quot;STATICVARIABLES&quot;</span>
428:       <span class="ruby-comment cmt">#    svcurrentcompany = static_variables.add_element &quot;SVCURRENTCOMPANY&quot;</span>
429:       <span class="ruby-comment cmt">#    svcurrentcompany.text = @institution.config_value</span>
430:       <span class="ruby-comment cmt">#    requestdata = import_data.add_element &quot;REQUESTDATA&quot;</span>
431:       <span class="ruby-comment cmt">#</span>
432:       <span class="ruby-comment cmt">#    while count&lt;2</span>
433:       <span class="ruby-comment cmt">#      tally_message = requestdata.add_element &quot;TALLYMESSAGE&quot;</span>
434:       <span class="ruby-comment cmt">#      currency = tally_message.add_element &quot;CURRENCY&quot;</span>
435:       <span class="ruby-comment cmt">#      currency.add_attribute(&quot;NAME&quot;,@currency.config_value)</span>
436:       <span class="ruby-comment cmt">#      currency.add_attribute(&quot;RESERVEDNAME&quot;,&quot;&quot;)</span>
437:       <span class="ruby-comment cmt">#      additional_name = currency.add_element(&quot;ADDITIONALNAME&quot;)</span>
438:       <span class="ruby-comment cmt">#      additional_name.text  = @currency.config_value</span>
439:       <span class="ruby-comment cmt">#      expanded_name = currency.add_element(&quot;EXPANDEDSYMBOL&quot;)</span>
440:       <span class="ruby-comment cmt">#      expanded_name.text = @currency.config_value</span>
441:       <span class="ruby-comment cmt">#      decimal_symbol = currency.add_element(&quot;DECIMALNAME&quot;)</span>
442:       <span class="ruby-comment cmt">#      decimal_symbol.text =&quot;No&quot;</span>
443:       <span class="ruby-comment cmt">#      original_name = currency.add_element(&quot;ORIGINALNAME&quot;)</span>
444:       <span class="ruby-comment cmt">#      original_name.text = @currency.config_value</span>
445:       <span class="ruby-comment cmt">#      is_suffix = currency.add_element(&quot;ISSUFFIX&quot;)</span>
446:       <span class="ruby-comment cmt">#      is_suffix.text = &quot;No&quot;</span>
447:       <span class="ruby-comment cmt">#      has_space = currency.add_element(&quot;HASSPACE&quot;)</span>
448:       <span class="ruby-comment cmt">#      has_space.text = &quot;Yes&quot;</span>
449:       <span class="ruby-comment cmt">#      in_millions = currency.add_element(&quot;INMILLIONS&quot;)</span>
450:       <span class="ruby-comment cmt">#      in_millions.text = &quot;No&quot;</span>
451:       <span class="ruby-comment cmt">#      decimal_places = currency.add_element(&quot;DECIMALSPLACES&quot;)</span>
452:       <span class="ruby-comment cmt">#      decimal_places.text = &quot;2&quot;</span>
453:       <span class="ruby-comment cmt">#      decimal_places_for_printing = currency.add_element(&quot;DECIMALPLACESFORPRINTING&quot;)</span>
454:       <span class="ruby-comment cmt">#      decimal_places_for_printing.text = &quot;2&quot;</span>
455:       <span class="ruby-comment cmt">#      count += 1</span>
456:       <span class="ruby-comment cmt">#    end</span>
457: 
458:       <span class="ruby-identifier">doc</span>.<span class="ruby-identifier">add_element</span> <span class="ruby-identifier">enevelope</span>
459:       <span class="ruby-identifier">file</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">doc</span>
460:       <span class="ruby-identifier">file</span>.<span class="ruby-identifier">close</span>
461: 
462:       <span class="ruby-identifier">send_file</span> <span class="ruby-value str">&quot;Tally.xml&quot;</span>, <span class="ruby-identifier">:type=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;xml&quot;</span>
463: 
464:     <span class="ruby-keyword kw">end</span>
465:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000513" class="method-detail">
        <a name="M000513"></a>

        <div class="method-heading">
          <a href="#M000513" class="method-signature">
          <span class="method-name">index</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000513-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000513-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/xml_controller.rb, line 8</span>
 8:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">index</span>
 9:     
10:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000514" class="method-detail">
        <a name="M000514"></a>

        <div class="method-heading">
          <a href="#M000514" class="method-signature">
          <span class="method-name">settings</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000514-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000514-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/xml_controller.rb, line 12</span>
12:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">settings</span>
13:     <span class="ruby-ivar">@xml</span> = <span class="ruby-constant">Xml</span>.<span class="ruby-identifier">get_multiple_finance_as_hash</span> [<span class="ruby-value str">'Salary'</span>, <span class="ruby-value str">'Fee'</span>, <span class="ruby-value str">'Donation'</span>]
14:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span>
15:       <span class="ruby-constant">Xml</span>.<span class="ruby-identifier">set_ledger_name</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:xml_settings</span>])
16:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;XML settings updated successfully&quot;</span>
17:       <span class="ruby-identifier">redirect_to</span>  <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;settings&quot;</span>
18:     <span class="ruby-keyword kw">end</span>
19:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>